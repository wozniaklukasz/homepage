<!DOCTYPE html><html lang="en"><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-MG7JK6X8CN"></script><script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'G-MG7JK6X8CN', {
              page_path: window.location.pathname,
            });
          </script><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><title>Testing of redux action thunk | Łukasz Woźniak Software Developer</title><meta name="robots" content="index,follow"/><meta name="googlebot" content="index,follow"/><meta name="description" content="Practical approaches to test an application that uses async redux thunk action. Test will check effect of dispatched action on the state."/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@site"/><meta name="twitter:creator" content="@handle"/><meta property="og:url" content="https://lukaszwozniak.dev/"/><meta property="og:title" content="Testing of redux action thunk | Łukasz Woźniak Software Developer"/><meta property="og:description" content="Practical approaches to test an application that uses async redux thunk action. Test will check effect of dispatched action on the state."/><meta property="og:image" content="https://lukaszwozniak.dev/images/posts/testing-of-redux-action-thunk/testing-of-redux-action-thunk.jpg"/><meta property="og:image:alt" content="Testing of redux action thunk"/><meta property="og:image:width" content="800"/><meta property="og:image:height" content="600"/><meta property="og:site_name" content="Łukasz Woźniak Software Developer"/><link rel="preload" as="image" imagesrcset="https://lukaszwozniak.dev/images/lukasz-wozniak.jpg?auto=format&amp;fit=max&amp;w=256 1x, https://lukaszwozniak.dev/images/lukasz-wozniak.jpg?auto=format&amp;fit=max&amp;w=384 2x"/><meta name="next-head-count" content="20"/><link rel="preload" href="/_next/static/css/2a9e74b11d892dc78ce2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2a9e74b11d892dc78ce2.css" data-n-g=""/><link rel="preload" href="/_next/static/css/8460239a978d9aaa60fc.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8460239a978d9aaa60fc.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-7b87e6fdb567bca4c6f4.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.da6e78c416fe44b6a1a8.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.9ea8e44509c4f6164d91.js" as="script"/><link rel="preload" href="/_next/static/chunks/d396f6bcc30c5d41f4d85b3306df591174595d50.cb3bd33142fc1615d257.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-c22e5d6cea76a89c296e.js" as="script"/><link rel="preload" href="/_next/static/chunks/f337f6be30883f62ad40210a9906111202e75ef1.e695c0ecced4cdb5a6d4.js" as="script"/><link rel="preload" href="/_next/static/chunks/801fd52765eea4473fff6b66c6444039c97c82e1.8c3c716bbba903082656.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/blog/%5Bid%5D-3520a8e36fe861cb5ce1.js" as="script"/></head><body><div id="__next"><div class="layout_container__2t4v2"><header class="layout_header__2rhWq"><a class="utils_link__Sf0UQ" href="/">Home</a><a class="utils_link__Sf0UQ" href="/about">About me</a><a class="utils_link__Sf0UQ active" href="/blog">Blog</a></header><main><article><h1 class="utils_headingXl__1XecN">Testing of redux action thunk</h1><div class="utils_lightText__12Ckm"><div><time dateTime="2021-03-30">March 30, 2021</time></div><div><span class="tags_tag__2vozA"># javascript</span><span class="tags_tag__2vozA"># redux</span><span class="tags_tag__2vozA"># redux-thunk</span><span class="tags_tag__2vozA"># jest</span><span class="tags_tag__2vozA"># testing</span></div></div><div style="display:inline-block;max-width:100%;overflow:hidden;position:relative;box-sizing:border-box;margin:0"><div style="box-sizing:border-box;display:block;max-width:100%"><img style="max-width:100%;display:block;margin:0;border:none;padding:0" alt="" aria-hidden="true" role="presentation" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4MCIgaGVpZ2h0PSI3MjAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+"/></div><img alt="Testing of redux action thunk" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" style="visibility:hidden;position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/></div><div><p>In this post, I will present some practical approaches to test an application that uses thunks from the <a href="https://github.com/reduxjs/redux-thunk" target="_blank" rel="nofollow noopener noreferrer">redux-thunk</a> library.</p>
<p>While browsing the web looking for ways and good practices to test redux state, many times I came across tests that check implementation details, not logic.</p>
<p>I don't see much sense in such an approach, which will almost certainly be expensive to maintain - testing will become sensitive to change. What should be of interest to us is the effect of dispatched action on the state and possible check of selectors, if we have any.</p>
<h2>Thunk implementations test</h2>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// Arrange</span>
<span class="hljs-keyword">const</span> store = mockStore(initialState);

<span class="hljs-comment">// Act</span>
<span class="hljs-keyword">await</span> store.dispatch(someThunkFunction(requestPayload));

<span class="hljs-comment">// Assert</span>
<span class="hljs-keyword">const</span> expectedActions = [
 someImplementedFunction_1(<span class="hljs-literal">true</span>), <span class="hljs-comment">// expectation of implementation details</span>
 someImplementedFunction_2(<span class="hljs-string">'some param'</span>),
 someImplementedFunction_3(<span class="hljs-number">123</span>)
];
<span class="hljs-keyword">const</span> actions = store.getActions();

expect(actions).toEqual(expectedActions);</code></pre>
<p>The above example checks the actions executed by <code>someThunkFunction</code>. The <code>mockStore</code> function used in the example comes from the <a href="https://github.com/reduxjs/redux-mock-store" target="_blank" rel="nofollow noopener noreferrer">redux-mock-store</a> library.</p>
<p>Imagine you are doing refactoring and changing the implementation of <code>someThunkFunction</code>. From now on, calling two instead of three functions will set the appropriate state of the application.</p>
<pre><code class="hljs language-diff">someImplementedFunction_1(true),
<span class="hljs-addition">+ someImplementedFunction_2('some param', 123),</span>
<span class="hljs-deletion">- someImplementedFunction_3(123)</span></code></pre>
<p>If we change its implementation details, e.g. it will contain 2 actions instead of 3, but the effect on the state remains the same - the test will not pass. The information from this test is, in my opinion, useless.</p>
<h2>State test after thunk dispatch</h2>
<p>In this post, I will focus on testing async thunk action. We skip testing actions and action-creators because they should not contain anything worth testing (the example presented at the end of the post is based on the <a href="https://redux-toolkit.js.org/" target="_blank" rel="nofollow noopener noreferrer">Redux Toolkit</a>, which manages them itself). Single actions and selectors should be trivial.</p>
<p>We dispatch the thunk and check the state of the application we are interested in with the appropriate selectors (if we have any). Otherwise, we compare individual elements of the obtained state with expectations (never add additional selectors only for testing!). This allows us to freely modify <code>someThunkFunction</code>.</p>
<p>As long as the state is correct - we have a green test and we do not bother with it. If the result is different after the changes, we will get valuable information. We will see what the state after the dispatch looks like and decide whether to fix the implementation or adapt the test to the new state.</p>
<pre><code class="hljs language-typescript"><span class="hljs-comment">// Arrange</span>
<span class="hljs-keyword">const</span> store = mockStore(initialState);

<span class="hljs-comment">// Act</span>
<span class="hljs-keyword">await</span> store.dispatch(someThunkFunction(requestPayload));

<span class="hljs-comment">// Assert</span>
<span class="hljs-keyword">const</span> expectedState = {
 <span class="hljs-attr">app</span>: {
   <span class="hljs-attr">someBoolean</span>: <span class="hljs-literal">true</span>,
   <span class="hljs-attr">someString</span>: <span class="hljs-string">'some param'</span>,
   <span class="hljs-attr">someNumber</span>: <span class="hljs-number">123</span>
 }
}
<span class="hljs-keyword">const</span> state = store.getState();

expect(state).toEqual(expectedState);</code></pre>
<h2>Example of redux-thunk test</h2>
<p>To write tests as shown, you must enable state creation with an initial value of <code>preloadedState</code>.</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// getStore.ts</span>

<span class="hljs-keyword">const</span> rootReducer = combineReducers({
  <span class="hljs-attr">epics</span>: epicsReducer,
  <span class="hljs-attr">tasks</span>: tasksReducer
});

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> getStore = <span class="hljs-function">(<span class="hljs-params">preloadedState</span>) =></span> configureStore({
  <span class="hljs-attr">reducer</span>: rootReducer,
  <span class="hljs-attr">middleware</span>: [thunk],
  <span class="hljs-comment">// configureStore with preloadedState</span>
  preloadedState
});</code></pre>
<p>In our simple example, we have an array of Epic and Task objects. Tasks have an <code>epicId</code> field indicating the Epic they belong to. We will try to write test that removes epic with <code>id === 0</code> and tasks with <code>epicId === 0</code>.</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// epicsSlice.ts</span>

<span class="hljs-keyword">const</span> preloadedState = {
    <span class="hljs-attr">epics</span>: {
        <span class="hljs-attr">list</span>: [
            {<span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 0'</span>}, <span class="hljs-comment">// epic to remove</span>
            {<span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 1'</span>},
        ]
    },
    <span class="hljs-attr">tasks</span>: {
        <span class="hljs-attr">list</span>: [
            {<span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">epicId</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 0 first task'</span>}, <span class="hljs-comment">// task to remove (epicId: 0)</span>
            {<span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">epicId</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 0 second task'</span>}, <span class="hljs-comment">// task to remove (epicId: 0)</span>
            {<span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">epicId</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 1 first task'</span>},
            {<span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">epicId</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 1 second task'</span>},
        ]
    }
};</code></pre>
<p>Let's create the method <code>removeEpicAndItsTasksThunk</code> that removes an Epic and all Tasks pointing to that Epic based on the given <code>id</code>. To complicate the example a bit, we will add a <code>Promise</code> that returns ids of Tasks to delete.</p>
<pre><code class="hljs language-javascript"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> removeEpicAndItsTasksThunk = createAsyncThunk(<span class="hljs-string">'removeEpicAndItsTasks'</span>, <span class="hljs-keyword">async</span> (epicId, {
  getState,
  dispatch
}) => {
  <span class="hljs-keyword">const</span> state = getState();

  <span class="hljs-keyword">const</span> tasksId = <span class="hljs-keyword">await</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =></span> {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Waiting for some async action.'</span>);

    <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =></span> {
      <span class="hljs-keyword">const</span> ids = state.tasks.list
        .filter(<span class="hljs-function">(<span class="hljs-params">task</span>) =></span> task.epicId === epicId)
        .map(<span class="hljs-function">(<span class="hljs-params">task</span>) =></span> task.id);

      <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Async action resolved after (at least) 2000ms.'</span>);
      resolve(ids);
    }, <span class="hljs-number">2000</span>);
  });

  dispatch(removeTasksById(tasksId));
  dispatch(removeEpicById(epicId));
});</code></pre>
<h3>Arrange</h3>
<p>Thanks to <code>preloadedState</code> we can initialize the state the way we need. As I mentioned - we want to be sure, that the Epic and all Tasks in this Epic will be removed.</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// Arrange</span>
<span class="hljs-keyword">const</span> preloadedState = {
<span class="hljs-attr">epics</span>: {
  <span class="hljs-attr">list</span>: [
    {<span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 0'</span>}, <span class="hljs-comment">// epic to remove</span>
    {<span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 1'</span>},
  ]
},
<span class="hljs-attr">tasks</span>: {
  <span class="hljs-attr">list</span>: [
    {<span class="hljs-attr">id</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">epicId</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 0 first task'</span>}, <span class="hljs-comment">// task to remove (epicId: 0)</span>
    {<span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">epicId</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 0 second task'</span>}, <span class="hljs-comment">// task to remove (epicId: 0)</span>
    {<span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">epicId</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 1 first task'</span>},
    {<span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">epicId</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 1 second task'</span>},
  ]
}
};

<span class="hljs-keyword">const</span> expectedEpicList = [
  {<span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 1'</span>},
];

<span class="hljs-keyword">const</span> expectedTaskList = [
  {<span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">epicId</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 1 first task'</span>},
  {<span class="hljs-attr">id</span>: <span class="hljs-number">3</span>, <span class="hljs-attr">epicId</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'epic 1 second task'</span>},
];

<span class="hljs-keyword">const</span> store = getStore(preloadedState);</code></pre>
<h3>Act</h3>
<p>The only thing Act does is call <code>removeEpicAndItsTasksThunk</code> with some id (0 in our case). Additionally, we cover <code>removeTasksById</code> and <code>removeEpicById</code> methods.</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// Act</span>
<span class="hljs-keyword">await</span> store.dispatch(removeEpicAndItsTasksThunk(<span class="hljs-number">0</span>));</code></pre>
<h3>Assert</h3>
<p>In this section, we check if the state after calling <code>removeEpicAndItsTasksThunk</code> method is correct. Besides, we test two selectors: <code>getEpicsList</code> and <code>getTasksList</code>.</p>
<pre><code class="hljs language-javascript"><span class="hljs-comment">// Assert</span>
<span class="hljs-keyword">const</span> state = store.getState();
<span class="hljs-keyword">const</span> epicList = getEpicsList(state);
<span class="hljs-keyword">const</span> taskList = getTasksList(state);

expect(epicList).toEqual(expectedEpicList);
expect(taskList).toEqual(expectedTaskList);</code></pre>
<h2>Summary</h2>
<p>The presented approach of thunk testing provides high code coverage. We do not check implementation details, only the result. We increase the resistance of tests to change in the code that do not affect the resulting state of the application</p>
<p>Check out a <a href="https://github.com/wozniaklukasz/blog-testing-of-redux-action-thunk" target="_blank" rel="nofollow noopener noreferrer">repository with described example</a>.</p>
</div></article><div class="hero_container__2NgfT"><div style="display:inline-block;max-width:100%;overflow:hidden;position:relative;box-sizing:border-box;margin:0"><div style="box-sizing:border-box;display:block;max-width:100%"><img style="max-width:100%;display:block;margin:0;border:none;padding:0" alt="" aria-hidden="true" role="presentation" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ0IiBoZWlnaHQ9IjE0NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2ZXJzaW9uPSIxLjEiLz4="/></div><img alt="Łukasz Woźniak Software Developer" srcSet="https://lukaszwozniak.dev/images/lukasz-wozniak.jpg?auto=format&amp;fit=max&amp;w=256 1x, https://lukaszwozniak.dev/images/lukasz-wozniak.jpg?auto=format&amp;fit=max&amp;w=384 2x" src="https://lukaszwozniak.dev/images/lukasz-wozniak.jpg?auto=format&amp;fit=max&amp;w=384" decoding="async" class="utils_image__1Jwtg" style="visibility:inherit;position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/></div><p class="hero_text__2aSTh">Łukasz Woźniak - software developer specialized in React, Redux and TypeScript. Read more <a href="/about">about me</a>.</p></div></main><footer class="layout_footer__127N0"><div><a aria-label="GitHub" href="https://github.com/wozniaklukasz/" target="github" class="utils_lightText__12Ckm utils_link__Sf0UQ utils_headingLg__de7p0"><svg preserveAspectRatio="xMidYMid meet" class="entypo-svgicon entypo--GithubWithCircle" style="display:inline-block;height:1em;width:1em;fill:currentColor;user-select:none;vertical-align:text-top" viewBox="0 0 20 20"><path d="M10.015,9.949c0,0-0.01,0-0.015,0H9.985c-1.191,0-2.24-0.303-2.861,0.268c-0.371,0.342-0.527,0.754-0.527,1.197c0,1.852,1.483,2.08,3.389,2.08h0.029c1.905,0,3.389-0.229,3.389-2.08c0-0.443-0.156-0.856-0.527-1.197C12.255,9.646,11.206,9.949,10.015,9.949z M8.393,12.48c-0.363,0-0.656-0.408-0.656-0.91c0-0.502,0.293-0.908,0.656-0.908c0.363,0,0.657,0.406,0.657,0.908C9.051,12.072,8.757,12.48,8.393,12.48z M11.606,12.48c-0.363,0-0.657-0.408-0.657-0.91c0-0.502,0.294-0.908,0.657-0.908c0.362,0,0.656,0.406,0.656,0.908C12.263,12.072,11.969,12.48,11.606,12.48z M10,0.4c-5.302,0-9.6,4.298-9.6,9.6s4.298,9.6,9.6,9.6s9.6-4.298,9.6-9.6S15.302,0.4,10,0.4z M10.876,13.939c-0.172,0-0.514,0-0.876,0.002c-0.362-0.002-0.704-0.002-0.876-0.002c-0.76,0-3.772-0.059-3.772-3.689c0-0.834,0.286-1.445,0.755-1.955c-0.074-0.184-0.078-1.232,0.32-2.236c0,0,0.916,0.1,2.301,1.051C9.017,7.029,9.509,6.988,10,6.988s0.982,0.041,1.273,0.121c1.385-0.951,2.301-1.051,2.301-1.051c0.398,1.004,0.395,2.053,0.32,2.236c0.469,0.51,0.755,1.121,0.755,1.955C14.648,13.881,11.636,13.939,10.876,13.939z"></path></svg></a><a aria-label="LinkedIn" href="https://www.linkedin.com/in/wozniaklukaszg/" target="linkedin" class="utils_lightText__12Ckm utils_link__Sf0UQ utils_headingLg__de7p0"><svg preserveAspectRatio="xMidYMid meet" class="entypo-svgicon entypo--LinkedinWithCircle" style="display:inline-block;height:1em;width:1em;fill:currentColor;user-select:none;vertical-align:text-top" viewBox="0 0 20 20"><path d="M10,0.4c-5.302,0-9.6,4.298-9.6,9.6s4.298,9.6,9.6,9.6s9.6-4.298,9.6-9.6S15.302,0.4,10,0.4z M7.65,13.979H5.706V7.723H7.65V13.979z M6.666,6.955c-0.614,0-1.011-0.435-1.011-0.973c0-0.549,0.409-0.971,1.036-0.971c0.627,0,1.011,0.422,1.023,0.971C7.714,6.52,7.318,6.955,6.666,6.955z M14.75,13.979h-1.944v-3.467c0-0.807-0.282-1.355-0.985-1.355c-0.537,0-0.856,0.371-0.997,0.728c-0.052,0.127-0.065,0.307-0.065,0.486v3.607H8.814v-4.26c0-0.781-0.025-1.434-0.051-1.996h1.689l0.089,0.869h0.039c0.256-0.408,0.883-1.01,1.932-1.01c1.279,0,2.238,0.857,2.238,2.699V13.979z"></path></svg></a><a aria-label="Twitter" href="https://twitter.com/wozniaklukaszg/" target="twitter" class="utils_lightText__12Ckm utils_link__Sf0UQ utils_headingLg__de7p0"><svg preserveAspectRatio="xMidYMid meet" class="entypo-svgicon entypo--TwitterWithCircle" style="display:inline-block;height:1em;width:1em;fill:currentColor;user-select:none;vertical-align:text-top" viewBox="0 0 20 20"><path d="M10,0.4c-5.302,0-9.6,4.298-9.6,9.6s4.298,9.6,9.6,9.6s9.6-4.298,9.6-9.6S15.302,0.4,10,0.4z M13.905,8.264c0.004,0.082,0.005,0.164,0.005,0.244c0,2.5-1.901,5.381-5.379,5.381c-1.068,0-2.062-0.312-2.898-0.85c0.147,0.018,0.298,0.025,0.451,0.025c0.886,0,1.701-0.301,2.348-0.809c-0.827-0.016-1.525-0.562-1.766-1.312c0.115,0.021,0.233,0.033,0.355,0.033c0.172,0,0.34-0.023,0.498-0.066c-0.865-0.174-1.517-0.938-1.517-1.854V9.033C6.257,9.174,6.549,9.26,6.859,9.27C6.351,8.93,6.018,8.352,6.018,7.695c0-0.346,0.093-0.672,0.256-0.951c0.933,1.144,2.325,1.896,3.897,1.977c-0.033-0.139-0.049-0.283-0.049-0.432c0-1.043,0.846-1.891,1.891-1.891c0.543,0,1.035,0.23,1.38,0.598c0.431-0.086,0.835-0.242,1.2-0.459c-0.141,0.441-0.44,0.812-0.831,1.047c0.383-0.047,0.747-0.148,1.086-0.299C14.595,7.664,14.274,7.998,13.905,8.264z"></path></svg></a><a aria-label="Contact" class="utils_lightText__12Ckm utils_link__Sf0UQ utils_headingLg__de7p0" href="/contact"><svg preserveAspectRatio="xMidYMid meet" class="entypo-svgicon entypo--MailWithCircle" style="display:inline-block;height:1em;width:1em;fill:currentColor;user-select:none;vertical-align:text-top" viewBox="0 0 20 20"><path d="M10,0.3999634c-5.3019409,0-9.5999756,4.2980957-9.5999756,9.6000366S4.6980591,19.5999756,10,19.5999756S19.5999756,15.3019409,19.5999756,10S15.3019409,0.3999634,10,0.3999634z M6.2313232,7h7.5195923c0.3988037,0,0.1935425,0.5117188-0.0234985,0.6430664c-0.217041,0.1308594-3.2213135,1.9470215-3.333313,2.0144043s-0.256958,0.0996094-0.402771,0.0996094c-0.145874,0-0.2908325-0.0322266-0.402771-0.0996094C9.4765625,9.5900879,6.472229,7.7739258,6.255188,7.6430664C6.038208,7.5117188,5.8328857,7,6.2313232,7z M14,12.5c0,0.2099609-0.251709,0.5-0.444458,0.5H6.444458C6.251709,13,6,12.7099609,6,12.5c0,0,0-3.5544434,0-3.6467285c0-0.0917969-0.001709-0.2114258,0.171875-0.109375c0.246521,0.1445312,3.265625,1.9250488,3.416687,2.013916c0.151001,0.0888672,0.256897,0.0995483,0.402771,0.0995483c0.145813,0,0.251709-0.0106812,0.402771-0.0995483s3.1875-1.8688965,3.434021-2.0134277C14.001709,8.642334,14,8.7619629,14,8.8537598C14,8.9460449,14,12.5,14,12.5z"></path></svg></a></div><p class="utils_lightText__12Ckm">© 2021 Łukasz Woźniak. All rights reserved.</p></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"testing-of-redux-action-thunk","contentHtml":"\u003cp\u003eIn this post, I will present some practical approaches to test an application that uses thunks from the \u003ca href=\"https://github.com/reduxjs/redux-thunk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eredux-thunk\u003c/a\u003e library.\u003c/p\u003e\n\u003cp\u003eWhile browsing the web looking for ways and good practices to test redux state, many times I came across tests that check implementation details, not logic.\u003c/p\u003e\n\u003cp\u003eI don't see much sense in such an approach, which will almost certainly be expensive to maintain - testing will become sensitive to change. What should be of interest to us is the effect of dispatched action on the state and possible check of selectors, if we have any.\u003c/p\u003e\n\u003ch2\u003eThunk implementations test\u003c/h2\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Arrange\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e store = mockStore(initialState);\n\n\u003cspan class=\"hljs-comment\"\u003e// Act\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e store.dispatch(someThunkFunction(requestPayload));\n\n\u003cspan class=\"hljs-comment\"\u003e// Assert\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e expectedActions = [\n someImplementedFunction_1(\u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e), \u003cspan class=\"hljs-comment\"\u003e// expectation of implementation details\u003c/span\u003e\n someImplementedFunction_2(\u003cspan class=\"hljs-string\"\u003e'some param'\u003c/span\u003e),\n someImplementedFunction_3(\u003cspan class=\"hljs-number\"\u003e123\u003c/span\u003e)\n];\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e actions = store.getActions();\n\nexpect(actions).toEqual(expectedActions);\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe above example checks the actions executed by \u003ccode\u003esomeThunkFunction\u003c/code\u003e. The \u003ccode\u003emockStore\u003c/code\u003e function used in the example comes from the \u003ca href=\"https://github.com/reduxjs/redux-mock-store\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eredux-mock-store\u003c/a\u003e library.\u003c/p\u003e\n\u003cp\u003eImagine you are doing refactoring and changing the implementation of \u003ccode\u003esomeThunkFunction\u003c/code\u003e. From now on, calling two instead of three functions will set the appropriate state of the application.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-diff\"\u003esomeImplementedFunction_1(true),\n\u003cspan class=\"hljs-addition\"\u003e+ someImplementedFunction_2('some param', 123),\u003c/span\u003e\n\u003cspan class=\"hljs-deletion\"\u003e- someImplementedFunction_3(123)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIf we change its implementation details, e.g. it will contain 2 actions instead of 3, but the effect on the state remains the same - the test will not pass. The information from this test is, in my opinion, useless.\u003c/p\u003e\n\u003ch2\u003eState test after thunk dispatch\u003c/h2\u003e\n\u003cp\u003eIn this post, I will focus on testing async thunk action. We skip testing actions and action-creators because they should not contain anything worth testing (the example presented at the end of the post is based on the \u003ca href=\"https://redux-toolkit.js.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003eRedux Toolkit\u003c/a\u003e, which manages them itself). Single actions and selectors should be trivial.\u003c/p\u003e\n\u003cp\u003eWe dispatch the thunk and check the state of the application we are interested in with the appropriate selectors (if we have any). Otherwise, we compare individual elements of the obtained state with expectations (never add additional selectors only for testing!). This allows us to freely modify \u003ccode\u003esomeThunkFunction\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eAs long as the state is correct - we have a green test and we do not bother with it. If the result is different after the changes, we will get valuable information. We will see what the state after the dispatch looks like and decide whether to fix the implementation or adapt the test to the new state.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-typescript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Arrange\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e store = mockStore(initialState);\n\n\u003cspan class=\"hljs-comment\"\u003e// Act\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e store.dispatch(someThunkFunction(requestPayload));\n\n\u003cspan class=\"hljs-comment\"\u003e// Assert\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e expectedState = {\n \u003cspan class=\"hljs-attr\"\u003eapp\u003c/span\u003e: {\n   \u003cspan class=\"hljs-attr\"\u003esomeBoolean\u003c/span\u003e: \u003cspan class=\"hljs-literal\"\u003etrue\u003c/span\u003e,\n   \u003cspan class=\"hljs-attr\"\u003esomeString\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'some param'\u003c/span\u003e,\n   \u003cspan class=\"hljs-attr\"\u003esomeNumber\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e123\u003c/span\u003e\n }\n}\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e state = store.getState();\n\nexpect(state).toEqual(expectedState);\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eExample of redux-thunk test\u003c/h2\u003e\n\u003cp\u003eTo write tests as shown, you must enable state creation with an initial value of \u003ccode\u003epreloadedState\u003c/code\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// getStore.ts\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e rootReducer = combineReducers({\n  \u003cspan class=\"hljs-attr\"\u003eepics\u003c/span\u003e: epicsReducer,\n  \u003cspan class=\"hljs-attr\"\u003etasks\u003c/span\u003e: tasksReducer\n});\n\n\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e getStore = \u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003epreloadedState\u003c/span\u003e) =\u003e\u003c/span\u003e configureStore({\n  \u003cspan class=\"hljs-attr\"\u003ereducer\u003c/span\u003e: rootReducer,\n  \u003cspan class=\"hljs-attr\"\u003emiddleware\u003c/span\u003e: [thunk],\n  \u003cspan class=\"hljs-comment\"\u003e// configureStore with preloadedState\u003c/span\u003e\n  preloadedState\n});\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIn our simple example, we have an array of Epic and Task objects. Tasks have an \u003ccode\u003eepicId\u003c/code\u003e field indicating the Epic they belong to. We will try to write test that removes epic with \u003ccode\u003eid === 0\u003c/code\u003e and tasks with \u003ccode\u003eepicId === 0\u003c/code\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// epicsSlice.ts\u003c/span\u003e\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e preloadedState = {\n    \u003cspan class=\"hljs-attr\"\u003eepics\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003elist\u003c/span\u003e: [\n            {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 0'\u003c/span\u003e}, \u003cspan class=\"hljs-comment\"\u003e// epic to remove\u003c/span\u003e\n            {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 1'\u003c/span\u003e},\n        ]\n    },\n    \u003cspan class=\"hljs-attr\"\u003etasks\u003c/span\u003e: {\n        \u003cspan class=\"hljs-attr\"\u003elist\u003c/span\u003e: [\n            {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eepicId\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 0 first task'\u003c/span\u003e}, \u003cspan class=\"hljs-comment\"\u003e// task to remove (epicId: 0)\u003c/span\u003e\n            {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eepicId\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 0 second task'\u003c/span\u003e}, \u003cspan class=\"hljs-comment\"\u003e// task to remove (epicId: 0)\u003c/span\u003e\n            {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eepicId\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 1 first task'\u003c/span\u003e},\n            {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eepicId\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 1 second task'\u003c/span\u003e},\n        ]\n    }\n};\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eLet's create the method \u003ccode\u003eremoveEpicAndItsTasksThunk\u003c/code\u003e that removes an Epic and all Tasks pointing to that Epic based on the given \u003ccode\u003eid\u003c/code\u003e. To complicate the example a bit, we will add a \u003ccode\u003ePromise\u003c/code\u003e that returns ids of Tasks to delete.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-keyword\"\u003eexport\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e removeEpicAndItsTasksThunk = createAsyncThunk(\u003cspan class=\"hljs-string\"\u003e'removeEpicAndItsTasks'\u003c/span\u003e, \u003cspan class=\"hljs-keyword\"\u003easync\u003c/span\u003e (epicId, {\n  getState,\n  dispatch\n}) =\u003e {\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e state = getState();\n\n  \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e tasksId = \u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003ePromise\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003eresolve\u003c/span\u003e) =\u003e\u003c/span\u003e {\n    \u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(\u003cspan class=\"hljs-string\"\u003e'Waiting for some async action.'\u003c/span\u003e);\n\n    \u003cspan class=\"hljs-built_in\"\u003esetTimeout\u003c/span\u003e(\u003cspan class=\"hljs-function\"\u003e() =\u003e\u003c/span\u003e {\n      \u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e ids = state.tasks.list\n        .filter(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003etask\u003c/span\u003e) =\u003e\u003c/span\u003e task.epicId === epicId)\n        .map(\u003cspan class=\"hljs-function\"\u003e(\u003cspan class=\"hljs-params\"\u003etask\u003c/span\u003e) =\u003e\u003c/span\u003e task.id);\n\n      \u003cspan class=\"hljs-built_in\"\u003econsole\u003c/span\u003e.log(\u003cspan class=\"hljs-string\"\u003e'Async action resolved after (at least) 2000ms.'\u003c/span\u003e);\n      resolve(ids);\n    }, \u003cspan class=\"hljs-number\"\u003e2000\u003c/span\u003e);\n  });\n\n  dispatch(removeTasksById(tasksId));\n  dispatch(removeEpicById(epicId));\n});\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eArrange\u003c/h3\u003e\n\u003cp\u003eThanks to \u003ccode\u003epreloadedState\u003c/code\u003e we can initialize the state the way we need. As I mentioned - we want to be sure, that the Epic and all Tasks in this Epic will be removed.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Arrange\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e preloadedState = {\n\u003cspan class=\"hljs-attr\"\u003eepics\u003c/span\u003e: {\n  \u003cspan class=\"hljs-attr\"\u003elist\u003c/span\u003e: [\n    {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 0'\u003c/span\u003e}, \u003cspan class=\"hljs-comment\"\u003e// epic to remove\u003c/span\u003e\n    {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 1'\u003c/span\u003e},\n  ]\n},\n\u003cspan class=\"hljs-attr\"\u003etasks\u003c/span\u003e: {\n  \u003cspan class=\"hljs-attr\"\u003elist\u003c/span\u003e: [\n    {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eepicId\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 0 first task'\u003c/span\u003e}, \u003cspan class=\"hljs-comment\"\u003e// task to remove (epicId: 0)\u003c/span\u003e\n    {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eepicId\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 0 second task'\u003c/span\u003e}, \u003cspan class=\"hljs-comment\"\u003e// task to remove (epicId: 0)\u003c/span\u003e\n    {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eepicId\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 1 first task'\u003c/span\u003e},\n    {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eepicId\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 1 second task'\u003c/span\u003e},\n  ]\n}\n};\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e expectedEpicList = [\n  {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 1'\u003c/span\u003e},\n];\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e expectedTaskList = [\n  {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eepicId\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 1 first task'\u003c/span\u003e},\n  {\u003cspan class=\"hljs-attr\"\u003eid\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003eepicId\u003c/span\u003e: \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e, \u003cspan class=\"hljs-attr\"\u003ename\u003c/span\u003e: \u003cspan class=\"hljs-string\"\u003e'epic 1 second task'\u003c/span\u003e},\n];\n\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e store = getStore(preloadedState);\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eAct\u003c/h3\u003e\n\u003cp\u003eThe only thing Act does is call \u003ccode\u003eremoveEpicAndItsTasksThunk\u003c/code\u003e with some id (0 in our case). Additionally, we cover \u003ccode\u003eremoveTasksById\u003c/code\u003e and \u003ccode\u003eremoveEpicById\u003c/code\u003e methods.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Act\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003eawait\u003c/span\u003e store.dispatch(removeEpicAndItsTasksThunk(\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e));\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eAssert\u003c/h3\u003e\n\u003cp\u003eIn this section, we check if the state after calling \u003ccode\u003eremoveEpicAndItsTasksThunk\u003c/code\u003e method is correct. Besides, we test two selectors: \u003ccode\u003egetEpicsList\u003c/code\u003e and \u003ccode\u003egetTasksList\u003c/code\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-javascript\"\u003e\u003cspan class=\"hljs-comment\"\u003e// Assert\u003c/span\u003e\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e state = store.getState();\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e epicList = getEpicsList(state);\n\u003cspan class=\"hljs-keyword\"\u003econst\u003c/span\u003e taskList = getTasksList(state);\n\nexpect(epicList).toEqual(expectedEpicList);\nexpect(taskList).toEqual(expectedTaskList);\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eSummary\u003c/h2\u003e\n\u003cp\u003eThe presented approach of thunk testing provides high code coverage. We do not check implementation details, only the result. We increase the resistance of tests to change in the code that do not affect the resulting state of the application\u003c/p\u003e\n\u003cp\u003eCheck out a \u003ca href=\"https://github.com/wozniaklukasz/blog-testing-of-redux-action-thunk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003erepository with described example\u003c/a\u003e.\u003c/p\u003e\n","title":"Testing of redux action thunk","date":"2021-03-30","tags":["javascript","redux","redux-thunk","jest","testing"],"description":"Practical approaches to test an application that uses async redux thunk action. Test will check effect of dispatched action on the state.","slug":"testing-of-redux-action-thunk","image":"testing-of-redux-action-thunk.jpg"}},"__N_SSG":true},"page":"/blog/[id]","query":{"id":"testing-of-redux-action-thunk"},"buildId":"MW7QuLAUS8MM7PHB0DtTM","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-28654a8145d7603786fc.js"></script><script src="/_next/static/chunks/main-7b87e6fdb567bca4c6f4.js" async=""></script><script src="/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/_next/static/chunks/framework.da6e78c416fe44b6a1a8.js" async=""></script><script src="/_next/static/chunks/commons.9ea8e44509c4f6164d91.js" async=""></script><script src="/_next/static/chunks/d396f6bcc30c5d41f4d85b3306df591174595d50.cb3bd33142fc1615d257.js" async=""></script><script src="/_next/static/chunks/pages/_app-c22e5d6cea76a89c296e.js" async=""></script><script src="/_next/static/chunks/f337f6be30883f62ad40210a9906111202e75ef1.e695c0ecced4cdb5a6d4.js" async=""></script><script src="/_next/static/chunks/801fd52765eea4473fff6b66c6444039c97c82e1.8c3c716bbba903082656.js" async=""></script><script src="/_next/static/chunks/pages/blog/%5Bid%5D-3520a8e36fe861cb5ce1.js" async=""></script><script src="/_next/static/MW7QuLAUS8MM7PHB0DtTM/_buildManifest.js" async=""></script><script src="/_next/static/MW7QuLAUS8MM7PHB0DtTM/_ssgManifest.js" async=""></script></body></html>